VWc.prototype.xC=X(1435,g("L"));EWc.prototype.Mw=X(1434,function(a){return zn(this,5,a,yWc)});FWc.prototype.Mw=X(1433,function(a){return this.message.Mw(a)});VWc.prototype.Mw=X(1432,g("J"));function dui(){return Hz.getInstance().C.isTdOrganizer}function eui(a,b){return a.C[b]}function fui(a,b,c,d){YN(a,function(e){e=e.D(b,this.C.$a,this.C.Ya,this.ma,this.tb,this.Aa,this.O,c,d);WN(this,e);e.setVisible(!0)},"ritzprotectionpane")}
function gui(a){if(a.D)return new dU(null,a.D);a=new PE(a.F,a.jp()?ene():a.C);return new dU(a,null)}var hui={2:[{}]},iui={6:Cja};function jui(a){var b=[],c="";a=We(a);for(var d=0;d<a.length;){var e=vRb(a,d);Id(",;",e)||" "==e&&uRb(c).Af()?(Gd(c)||b.push(uRb(c)),c="",d++):(c+=e,d+=e.length)}Gd(c)||b.push(uRb(c));return b}
function kui(a,b){a='<div class="waffle-flat-range-select-holder">'+Qaf({jya:!0},b);a+=Q(ux({od:"waffle-flat-range-select-done",content:tu("Ok"),style:2},b));return R(a+'<div class="waffle-flat-range-select-message">Select a range</div></div>')}function lui(a,b){a=""+Q(ux({od:"waffle-flat-multi-range-remove",content:tu(""+(a.Fe?Q(Fy({icon:"docs-icon-img docs-icon-close"},b)):"x")),title:"Remove range",style:4},b));return R(a)}
function mui(a,b){var c=a.Fe;return R('<div class="waffle-flat-multi-range-row">'+Qaf({jya:!0},b)+(c?lui(a,b):'<table class="waffle-flat-multi-range-remove-table"><tr><td>'+lui(a,b)+"</td></tr></table>")+"</div>")}
function nui(a,b){a='<div class="waffle-flat-multi-range-select"><div class="waffle-flat-multi-range-holder"></div><div class="waffle-flat-multi-range-add-another">Add another range</div><br/>'+Q(ux({od:"waffle-flat-multi-range-select-done",content:tu("Ok"),style:2},b));return R(a+'<div class="waffle-flat-multi-range-select-message">Select a range</div></div>')}function oui(a,b,c,d,e){this.D=a;this.C=b;this.F=c;this.H=d;this.id=e}function pui(a){this.rb=hn(a,-1,0)}u(pui,mn);
function qui(){var a=void 0===a?on(pui):a;return new rui(a)}pui.prototype.kb=function(){return new rui(this)};pui.prototype.getId=function(){return An(this,1)};function rui(a){Cn.call(this,a)}u(rui,Cn);rui.prototype.getId=function(){return this.message.getId()};rui.prototype.Hc=function(a){return Mn(this,1,a)};function sui(a){this.rb=hn(a,-1,0)}u(sui,mn);p=sui.prototype;p.kb=function(){return new tui(this)};p.Ts=function(){return qn(this,2)};p.getEmail=function(){return An(this,2)};p.getId=function(){return An(this,3)};p.hasType=function(){return qn(this,4)};p.getType=function(){return wn(this,4,0)};function tui(a){Cn.call(this,a)}u(tui,Cn);p=tui.prototype;p.Ts=function(){return this.message.Ts()};p.getEmail=function(){return this.message.getEmail()};p.getId=function(){return this.message.getId()};
p.Hc=function(a){return Mn(this,3,a)};p.hasType=function(){return this.message.hasType()};p.getType=function(){return this.message.getType()};p.setType=function(a){return Hn(this,4,a)};p.clearType=function(){return En(this,4)};function uui(a){this.rb=hn(a,-1,0)}u(uui,mn);uui.prototype.kb=function(){return new vui(this)};uui.prototype.getId=function(){return An(this,1)};uui.prototype.qq=function(a){return zn(this,2,a,sui)};function vui(a){Cn.call(this,a)}u(vui,Cn);vui.prototype.getId=function(){return this.message.getId()};vui.prototype.Hc=function(a){return Mn(this,1,a)};vui.prototype.qq=function(a){return this.message.qq(a)};function wui(a){this.rb=hn(a,-1,0)}u(wui,mn);wui.prototype.kb=function(){return new xui(this)};wui.prototype.getId=function(){return An(this,1)};wui.prototype.hasType=function(){return qn(this,3)};wui.prototype.getType=function(){return wn(this,3,0)};function xui(a){Cn.call(this,a)}u(xui,Cn);p=xui.prototype;p.getId=function(){return this.message.getId()};p.Hc=function(a){return Mn(this,1,a)};function yui(a,b){return Mn(a,2,b)}p.hasType=function(){return this.message.hasType()};p.getType=function(){return this.message.getType()};
p.setType=function(a){return Hn(this,3,a)};p.clearType=function(){return En(this,3)};function zui(a){this.rb=hn(a,-1,0)}u(zui,mn);function Aui(){var a=void 0===a?on(zui):a;return new Bui(a)}zui.prototype.kb=function(){return new Bui(this)};zui.prototype.getId=function(){return An(this,1)};zui.prototype.getResult=function(){return wn(this,2,0)};function Bui(a){Cn.call(this,a)}u(Bui,Cn);Bui.prototype.getId=function(){return this.message.getId()};Bui.prototype.Hc=function(a){return Mn(this,1,a)};Bui.prototype.getResult=function(){return this.message.getResult()};
function Cui(a,b){return Hn(a,2,b)};function Dui(a){this.rb=hn(a,-1,0)}u(Dui,mn);function Eui(){var a=void 0===a?on(Dui):a;return new Fui(a)}Dui.prototype.kb=function(){return new Fui(this)};Dui.prototype.getRange=function(){return this.Mb(1,Nn)};Dui.prototype.Mw=function(a){return zn(this,3,a,Nn)};Dui.prototype.Vd=function(){return An(this,4)};function Fui(a){Cn.call(this,a)}u(Fui,Cn);Fui.prototype.getRange=function(){return this.message.getRange()};Fui.prototype.Mw=function(a){return this.message.Mw(a)};Fui.prototype.Vd=function(){return this.message.Vd()};
Fui.prototype.Di=function(a){return Mn(this,4,a)};function Gui(a){this.rb=hn(a,-1,0)}u(Gui,mn);Gui.prototype.kb=function(){return new Hui(this)};Gui.prototype.Kl=function(){return qn(this,3)};Gui.prototype.getData=function(){return this.Mb(3,Dui)};function Hui(a){Cn.call(this,a)}u(Hui,Cn);Hui.prototype.Kl=function(){return this.message.Kl()};Hui.prototype.getData=function(){return this.message.getData()};function Iui(a,b,c,d,e){cI.call(this,66);this.ld=a;this.Wj=b?Hd(b):void 0;this.F=c;this.C=d;this.J=e}u(Iui,cI);Iui.prototype.Kk=function(){return"Updated protected range "+((this.Wj||"")+".")};Iui.prototype.Pd=function(){var a=void 0===a?on(Gui):a;a=new Hui(a);var b=Eui();this.Wj&&b.Di(this.Wj);var c=r5e(this.F);Kn(b,5,c);if(this.C)for(c=0;c<this.C.length;c++){var d=r5e(this.C[c]);In(b,6,d)}else Fn(a,4,!0);Fn(b,2,this.J);b=Dn(b);Kn(a,3,b);Mn(a,1,this.ld);return Dn(a)};Iui.prototype.wg=l(!1);function Jui(a,b,c){B.call(this);this.D={};this.F=null;this.L=a;this.H=b;this.J=c;this.C=null}u(Jui,B);function Kui(a,b,c,d){var e=Dn(qui().Hc(b)),f=w(c,d);a.C=hk(ik(To(Ko(a.L.hf("/protectedrange/acllookup"),{data:e.ub()}),"POST"),function(h){a.C=null;h=nn(uui,Yj(h.Pe(),hui));a.D[b]=An(h,5);var k=a.J.C[b];k&&k.xC()&&(h=Dn(Hn(h.kb(),3,5)));f(h,!0)}),function(){a.C=null;delete a.D[b];f(null,!1)}).Ue()}
Jui.prototype.update=function(a,b,c){var d=this,e=5==a.getType(),f=eui(this.J,a.getId()),h=null;f&&f.xC()!=e&&(h=new Iui(f.getId(),void 0,gui(f),void 0,e));if(e)h?(dI(h,function(m){var n=Aui().Hc(a.getId());if(m){var q=void 0===q?on(CWc):q;m=new DWc(q);m=Fn(m,3,!0);d.F=Dn(m);Cui(n,2)}else Cui(n,5);b.call(c,a,Dn(n),!0)}),this.H.C(h)):(e=Dn(Cui(Aui().Hc(a.getId()),1)),b.call(c,a,e,!0));else{e=this.D[a.getId()];a.getId();a=Dn(yui(a.kb(),e));var k=w(b,c,a);this.C=hk(ik(To(Ko(this.L.hf("/protectedrange/aclupdate"),
{data:a.ub()}),"POST"),function(m){var n=h;d.C=null;m=nn(zui,Yj(m.Pe(),iui));3==m.getResult()&&(d.D[m.getId()]=An(m,5));qn(m,6)&&(d.F=m.Mb(6,CWc));k(m,!0);if(n)switch(m.getResult()){case 3:case 2:case 1:case 8:d.H.C(n)}}),function(){d.C=null;k(null,!1)}).Ue()}};Jui.prototype.Na=function(){B.prototype.Na.call(this);Hf(this.C)};function Lui(a,b){a='<div id="waffle-ritz-protection-acl-loading"><div id="waffle-ritz-protection-acl-loading-text" class="waffle-ritz-protection-acl-loading-text"></div><div id="waffle-ritz-protection-acl-loading-spinner" class="waffle-ritz-protection-acl-loading-spinner">'+Q(fBf())+'</div></div><div id="waffle-ritz-protection-acl-content">';var c='<div class="waffle-ritz-protection-chooser-area" id="waffle-ritz-protection-chooser-area"><div class="waffle-ritz-protection-type-buttons" id="waffle-ritz-protection-type-buttons" role="radiogroup">'+
Q(NP({label:"Show a warning when editing this range",name:"edittype",value:"soft"},b));c+=Q(NP({label:"Restrict who can edit this range",name:"edittype",value:"hard"},b));c=c+'</div><div id="waffle-ritz-protection-dropdown" class="waffle-ritz-protection-dropdown" aria-label="'+vu("Who can edit this range");b=R(c+'"></div></div>');b=a+b;a=R('<div id="waffle-ritz-protection-custom-container" class="waffle-ritz-protection-custom-container">'+R('<div class="waffle-ritz-protection-acl-header"><span class="waffle-ritz-protection-acl-header-name" id="waffle-ritz-protection-acl-header">Choose who can edit</span><span class="waffle-ritz-protection-acl-header-edit"><div id="waffle-ritz-protection-acl-header-edit-checkbox" class="waffle-ritz-protection-acl-header-edit-checkbox"></div></span></div><div class="waffle-ritz-protection-acl-table-container"><table class="waffle-ritz-protection-acl-table" id="waffle-ritz-protection-acl-table" cellspacing="0"><colgroup><col class="waffle-ritz-protection-acl-scope-col"><col class="waffle-ritz-protection-acl-edit-col"></colgroup></table></div>')+
'<div id="waffle-ritz-protection-input-butter"></div>'+R('<div class="waffle-ritz-protection-add-editors-container"><div class="waffle-ritz-protection-add-editors-label">Add editors:</div><textarea id="waffle-ritz-protection-add-editors-input" class="waffle-ritz-protection-add-editors-input jfk-textinput"></textarea></div>')+"</div>");b=b+a+'<div id="waffle-ritz-protection-list" class="waffle-ritz-protection-list" aria-label=\''+vu("Protected ranges list");return R(b+'\' role="listbox"></div></div>')}
function Mui(a){var b=a.wmc,c=a.vmc;return R('<div class="waffle-ritz-protection-acl-butter"><div class="waffle-ritz-protection-acl-butter-text">'+Q(a.text)+"</div>"+(b?" "+(c?'<a href="'+S(wu(c))+'" target="_blank" class="waffle-ritz-protection-acl-butter-href" title="'+S(b)+'">'+Q(b)+"</a>":'<div class="waffle-ritz-protection-acl-butter-action" tabindex="0">'+Q(b)+"</div>"):"")+"</div>")}
function Nui(a){var b=a.ymc,c=a.zmc;return R('<table><tr class="waffle-ritz-protection-acl-row '+(a.Kmb?"waffle-ritz-protection-acl-missing":"")+'" role="row"><td role="rowheader"><div class="waffle-ritz-protection-acl-scope"><span class="waffle-ritz-protection-acl-icon-container" aria-hidden="true"></span><span class="waffle-ritz-protection-acl-text"><span class="waffle-ritz-protection-acl-name">'+Q(a.name)+"</span>"+(b?'  <span class="waffle-ritz-protection-acl-detail">'+Q(b)+"</span>":"")+(c?'&nbsp;<span class="waffle-ritz-protection-acl-email">'+
Q(c)+"</span>":"")+'</span></div></td><td role="gridcell"><span class="waffle-ritz-protection-acl-checkbox"></span></td></tr></table>')}function Oui(a){var b=a.Yhb;return R('<img src="'+S(xu(a.Xl))+'" class="waffle-ritz-protection-acl-custom-icon"><span class="waffle-ritz-protection-acl-default-icon apps-share-sprite '+S(b)+'"></span>')}
function Pui(a){var b=a.vg;return R('<div class="waffle-ritz-protection-item"><div class="waffle-ritz-protection-item-name">'+Q(a.name)+"</div>"+(b?'<div class="waffle-ritz-protection-item-range">'+Q(b)+"</div>":"")+"</div>")};function Qui(a,b){P.call(this,b);this.D=a;this.F=this.C=null}u(Qui,P);p=Qui.prototype;p.Nc=function(a){P.prototype.Nc.call(this,a);var b;qn(this.D,1)&&(b=An(this.D,1));switch(this.D.getType()){case 1:var c="vo-domain-public-icon";break;case 2:c="scope-icon-default-group";break;default:c="scope-icon-default-user"}a.appendChild(nu(Oui,{Xl:b||"",Yhb:c}))};
p.Ha=function(){P.prototype.Ha.call(this);this.C=this.Fa("waffle-ritz-protection-acl-custom-icon");this.F=this.Fa("waffle-ritz-protection-acl-default-icon");this.C.onerror=w(this.YEb,this);Rui(this,!1)};p.Cd=function(){delete this.C.onerror};p.YEb=function(){Rui(this,!0)};p.Pa=function(a){this.getElement()&&Tu(this.getElement(),"waffle.ritzprotection-icon-disabled",!a)};function Rui(a,b){b=!b&&qn(a.D,1);O(a.C,b);O(a.F,!b)};function Sui(a,b){P.call(this,b);this.C=a;this.D=new Qui(a,b);this.Ga(this.D);this.CT=new sx;this.Ga(this.CT)}u(Sui,P);p=Sui.prototype;p.qq=g("C");p.VS=function(){return this.CT.isChecked()};p.isEnabled=function(){return this.CT.isEnabled()};p.Ba=function(){var a;4==this.C.getType()?a="(you)":4==wn(this.C,6,0)&&(a="(owner)");var b=3==wn(this.C,6,0);a=nu(Nui,{name:An(this.C,5),ymc:a,zmc:this.C.getEmail()||void 0,Kmb:b});a=cm(this.oa(),"tr","waffle-ritz-protection-acl-row",a)[0];this.qb(a)};
p.Ha=function(){P.prototype.Ha.call(this);this.D.Xa(this.Fa("waffle-ritz-protection-acl-icon-container"));this.CT.Xa(this.Fa("waffle-ritz-protection-acl-checkbox"));var a=!1,b=!1;switch(wn(this.C,6,0)){case 1:b=a=!1;break;case 2:a=!0;b=!1;break;case 3:a=!0;b=!1;break;case 4:b=a=!0}4!=this.C.getType()||!a&&dui()||(b=!0);this.CT.Lb(a);this.CT.Pa(!b)};function Tui(a,b){P.call(this,b);this.H=a;this.C=new dy("Enter names or email addresses",this.oa());this.Ga(this.C);this.D=new P(this.oa());this.Ga(this.D);this.F=new sx;this.Ga(this.F)}u(Tui,P);p=Tui.prototype;p.reset=function(){var a=this.D.Dd(!0);If(a);this.C.setValue("")};p.setVisible=function(a){O(this.getElement(),a)};
p.Ha=function(){P.prototype.Ha.call(this);var a=this.oa();this.J=bm(a,"waffle-ritz-protection-input-butter");this.D.Xa(bm(a,"waffle-ritz-protection-acl-table"));var b=bm(a,"waffle-ritz-protection-add-editors-input");this.H.Rpa(b,{acCssName:"waffle-ritz-protection-ac-renderer"});var c=new By;this.Ga(c);c.Xa(b);this.C.Xa(b);this.F.Xa(bm(a,"waffle-ritz-protection-acl-header-edit-checkbox"));Iu(bm(a,"waffle-ritz-protection-acl-header-edit-checkbox"),"labelledby","waffle-ritz-protection-acl-header");this.getHandler().listen(b,
"focus",this.jHb).listen(b,"blur",this.hHb).listen(this.F,"change",this.HJb).listen(this.D,"change",this.pSb)};function Uui(a){var b=void 0;a.D.Ye(function(c){c.isEnabled()&&(void 0===b?b=c.VS():c.VS()!=b&&(b=null))},a);void 0===b&&(b=!0);a.F.Lb(b)}p.pSb=function(a){a.stopPropagation();Uui(this)};p.HJb=function(a){this.D.Ye(function(b){if(b.isEnabled()){var c=this.F.isChecked();b.CT.Lb(c)}},this);a.stopPropagation()};p.jHb=function(){wt(this.C.getElement(),"height","60px")};
p.hHb=function(){Gd(this.C.getValue())&&wt(this.C.getElement(),"height","")};function Vui(a,b){var c=b.kb();c.setType(4);a.D.Ye(function(d){if(d.VS())switch(d=d.qq(),d.getType()){case 1:Fn(c,4,!0);break;case 2:d=d.getId();gGa(c.rb,6,d,YFa);break;case 3:case 4:d=d.getId(),gGa(c.rb,5,d,YFa)}},a);a=jui(a.C.getValue());for(b=0;b<a.length;b++)gGa(c.rb,7,a[b].address,YFa);return Dn(c)}p.Na=function(){this.H.ZLa(this.C.getElement());P.prototype.Na.call(this)};function Wui(a){P.call(this,a);this.C=new JE("\u2014",void 0,this.oa());this.Ga(this.C);this.getHandler().listen(this,["aftershow","afterhide"],this.Edc)}u(Wui,P);p=Wui.prototype;p.Ha=function(){P.prototype.Ha.call(this);var a=this.oa();this.C.Xa(bm(a,"waffle-ritz-protection-dropdown"));a=bm(a,"waffle-ritz-protection-type-buttons");this.D=y$e("edittype",a);this.qa(this.D);this.D.le(this);this.getHandler().listen(this.D,"change",this.KQb)};
p.setValue=function(a){"EVERYONE"==a?(this.C.Pa(!1),uV(this.D,wV(this.D,0))):(this.C.Pa(!0),this.C.setValue(a),uV(this.D,wV(this.D,1)))};p.getValue=function(){return"soft"==u$e(this.D)?"EVERYONE":this.C.getValue()};p.KQb=function(){this.C.Pa("hard"==u$e(this.D))};p.Edc=function(a){a.stopPropagation()};function Xui(){this.C=[]}
Xui.prototype.Hb=function(a){var b=!0,c=!0,d=!0,e=!1,f=!1,h=!1,k="";this.ib=a;switch(a){case "SAVING":k="Saving\u2026";d=c=!1;b=!0;h=e=f=!1;break;case "SUCCESS":k="Changes saved!";d=c=!1;b=!0;e=f=!1;h=!0;break;case "LOADING":k="Loading permissions\u2026";b=c=!0;d=!1;f=!0;h=e=!1;break;case "LOADED":k="";b=c=!1;f=d=!0;h=e=!1;break;case "ERROR_LOADING":k="Unable to load permissions. Please try again later.";c=!1;d=b=!0;f=!1;e=!0;h=!1;break;case "ERROR_NO_PERMS":k="You no longer have permission to change the protection settings. Try contacting the owner of this spreadsheet if you think this is a mistake.",c=
!1,d=b=!0,f=!1,e=!0,h=!1}this.Aa=e;this.J=c;this.F=k;this.H=d;this.xa=f;this.R=b;this.L=!b;this.D=h};Xui.prototype.getState=g("ib");function Yui(a,b,c,d){Zv.call(this,void 0,void 0,d);this.D=a;this.C=b;this.F=c}u(Yui,Zv);Yui.prototype.refresh=function(a){this.Dd(!0);for(var b=Kmc(this.D),c=0;c<b.length;c++){var d=b[c];if(d.Af()&&d.um()&&!d.xC()&&d.getId()!=a){var e=d.Vd(),f=gui(d),h=d.getId();d=d.jp()?(d=SG(this.F,d.gb()))?d.we():"#REF":e0e(this.C,f)?f0e(this.C,f):"#REF";Gd(e)&&(e=d,d=null);this.Ga(new Zui(e,d,h,this.oa()),!0)}}};function Zui(a,b,c,d){Vv.call(this,void 0,new $ui,d);this.C=a;this.ke=b;this.Fdc=c}u(Zui,Vv);
Zui.prototype.getName=g("C");Zui.prototype.getRange=g("ke");function $ui(){}u($ui,Sv);$ui.prototype.Ob=l("waffle-ritz-protection-item");$ui.prototype.Ba=function(a){return nu(Pui,{name:a.getName(),vg:a.getRange()})};function avi(a,b,c,d,e,f,h,k,m){xy.call(this,void 0,void 0,m);this.setTitle("Range editing permissions");this.ma=a;this.C=new Xui;this.jb=k;this.ea=f;this.qa(this.ea);this.$a=e;this.F=new Tui(h,this.oa());this.Ga(this.F);this.O=new Wui(this.oa());this.Ga(this.O);this.Ca=this.Ya=this.Va=this.Sa=this.Ia=null;this.fb=!1;this.L=this.H=null;this.R=new Yui(b,c,d,this.oa());this.Ga(this.R);this.ob=b}u(avi,xy);p=avi.prototype;p.Ba=function(){xy.prototype.Ba.call(this);this.zb().appendChild(nu(Lui))};
p.Ha=function(){xy.prototype.Ha.call(this);var a=this.oa();this.Sa=bm(a,"waffle-ritz-protection-acl-content");this.Ia=bm(a,"waffle-ritz-protection-acl-loading");this.Va=bm(a,"waffle-ritz-protection-acl-loading-spinner");this.Ya=bm(a,"waffle-ritz-protection-acl-loading-text");this.Ca=this.oa().Ba("DIV",{id:"waffle-ritz-protection-title-butter"});this.oa().pr(this.Ca,dbb(this));this.F.Xa(bm(a,"waffle-ritz-protection-custom-container"));this.R.Xa(bm(a,"waffle-ritz-protection-list"));this.O.Xa(bm(a,"waffle-ritz-protection-chooser-area"));
this.getHandler().listen(this.O,"change",this.XGb).listen(this,"dialogselect",this.odc).listen(this.R,"action",this.FEb);bvi(this)};p.Gm=function(){var a=this.ea.F,b=this.jb;xy.prototype.Gm.call(this);b&&b(null!=a,a)};function bvi(a,b){z7(a,"LOADING");Kui(a.ea,b||a.ma,a.ndc,a)}
p.ndc=function(a,b){this.F.reset();if(b){b=this.C;var c=xn(a,2,sui).bd();b.C=[];for(var d,e,f={},h=0;h<c.length;h++){var k=c[h],m=wn(k,6,0);f[m]||(f[m]=[]);f[m].push(k);1==k.getType()&&(d=k);4==k.getType()&&(e=k)}d&&b.C.push(d);e&&b.C.push(e);c=[4,2,1,3];for(h=0;h<c.length;h++)if(k=c[h],f[k])for(m=0;m<f[k].length;m++){var n=f[k][m];n!=d&&n!=e&&b.C.push(n)}d=this.F;e=this.C.C;b=d.D.Dd(!0);If(b);b=!1;for(f=0;f<e.length;f++)c=new Sui(e[f]),d.D.Ga(c,!0),c.isEnabled()&&(b=!0);d.F.Pa(b);Uui(d);if(a.getId()!=
this.ma)this.O.setValue("CUSTOM");else{e=wn(a,3,0);this.H&&5!=e&&(e=4);d=this.O;a=IR(a,4).bd();b=this.C;f="";for(c=0;c<b.C.length;c++)if(h=b.C[c],1==h.getType()){f=An(h,5);break}b=f;for(f=d.C.eh()-1;0<=f;f--)d.C.wp(f);f=d.oa();b="People at "+b;dd(a,1)?d.C.Wc(new OS("Only you","YOU",f)):dd(a,2)&&d.C.Wc(new OS("Only you and spreadsheet owner","YOU_AND_OWNER",f));dd(a,3)&&d.C.Wc(new OS(b,"DOMAIN",f));d.C.Wc(new OS("Custom","CUSTOM",f));d.C.Wc(new xw(f));d.C.Wc(new OS("Copy permissions from another range",
"COPY",f));switch(e){case 5:d.setValue("EVERYONE");d.C.setValue("CUSTOM");break;case 1:d.setValue("YOU");break;case 2:d.setValue("YOU_AND_OWNER");break;case 3:d.setValue("DOMAIN");break;case 4:d.setValue("CUSTOM")}}z7(this,"LOADED");this.jd()}else z7(this,"ERROR_LOADING")};p.FEb=function(){var a=$v(this.R);bvi(this,a.Fdc)};
p.XGb=function(){var a=this.C,b=!1,c=!1;switch(this.O.getValue()){case "EVERYONE":case "YOU":case "YOU_AND_OWNER":case "DOMAIN":c=b=!1;break;case "CUSTOM":b=!0;c=!1;break;case "COPY":b=!1,c=!0}a.ea=c;a.O=b;a.ma=!c;a=this.C.ea;b=this.C.ma;c=this.C.O;a&&this.R.refresh(this.ma);this.F.setVisible(c);this.R.setVisible(a,!0);ov(this.D,"done",b);(a||c)&&this.jd()};
function z7(a,b){a.C.Hb(b);var c=a.C.R,d=a.C.L,e=a.C.J,f=a.C.H,h=a.C.Aa,k=a.C.xa,m=a.C.F;a.H&&"LOADED"==b&&(a.fb?a.Ca.appendChild(a.H):a.F.J.appendChild(a.H),b=a.oa().eb("waffle-ritz-protection-acl-butter-action",a.H),a.L&&a.L.Xa(b));h?(h=(new jv).Ef(pv,!0),mv(a,h),wv(a,"ok"),h=nv(h,"ok")):(h=(new jv).Ef({key:"done",caption:"Done"},!1),mv(a,h),wv(a,"done"),h=nv(h,"done"));O(a.Va,e);O(gv(a),f);k?(a.setTitle("Range editing permissions"),O(a.Ia,c)):(a.setTitle(m),O(a.Ia,!1));O(dbb(a),!0);a.oa().Ke(a.Ya,
m);O(a.Sa,d);a.jd();f?h.focus():a.focus();a.C.D&&(c=new Bo(function(){return a.setVisible(!1)},800),a.qa(c),c.start())}
p.nBa=function(){Hf(this.L);this.oa().removeNode(this.H);this.L=this.H=null;var a=void 0===a?on(wui):a;a=(new xui(a)).Hc(this.ma);var b=null;switch(this.O.getValue()){case "EVERYONE":b=Dn(a.setType(5));break;case "YOU":b=Dn(a.setType(1));break;case "YOU_AND_OWNER":b=Dn(a.setType(2));break;case "DOMAIN":b=Dn(a.setType(3));break;case "CUSTOM":b=Vui(this.F,Dn(a))}z7(this,"SAVING");this.ea.update(b,this.pdc,this)};
p.pdc=function(a,b,c){if(c)switch(b.getResult()){case 1:z7(this,"SUCCESS");break;case 2:z7(this,"SUCCESS");this.ob.D.dispatchEvent(cvi(this,a));dvi(this,Bn(b,4).bd());break;case 3:evi(this,!1,"Some email addresses couldn't be added.","Help","https://support.google.com/docs/answer/144687");a=Bn(b,3).bd();this.F.C.setValue(a.join(", "));z7(this,"LOADED");dvi(this,Bn(b,4).bd());break;case 4:evi(this,!0,"There was a problem while saving your permissions.","Try again",void 0,this.nBa);z7(this,"LOADED");
break;case 5:z7(this,"ERROR_NO_PERMS");break;case 6:evi(this,!0,"Sorry, you can't remove yourself as an editor.","Learn more","https://support.google.com/docs/answer/144687");z7(this,"LOADED");break;case 7:evi(this,!0,"Your settings weren\u2019t saved, as a collaborator has changed the list of editors. Please try again.");bvi(this);break;case 8:evi(this,!1,"Some email addresses couldn't be added.","Help","https://support.google.com/docs/answer/144687"),z7(this,"LOADED")}else evi(this,!0,"There was a problem while saving your permissions.",
"Try again",void 0,this.nBa),z7(this,"LOADED")};
function cvi(a,b){if(5==b.getType())return new oui([],[],!1,!1,b.getId());a=a.C.C;var c=a.filter(function(m){return(2==wn(m,6,0)||3==wn(m,6,0))&&4!=m.getType()&&1!=m.getType()}),d=Bn(b,5).bd().concat(Bn(b,6).bd()),e=new Set(d);d=c.map(function(m){return m.getId()}).filter(function(m){return!e.has(m)});var f=new Set(d);c=c.filter(function(m){return f.has(m.getId())}).map(function(m){return m.getEmail()});d=Bn(b,7).bd();a=a.some(function(m){return 2==wn(m,6,0)&&1==m.getType()});var h=!1,k=!1;a||!tn(b,
4)&&3!=b.getType()||(h=!0);a&&!tn(b,4)&&3!=b.getType()&&(k=!0);return new oui(c,d,h,k,b.getId())}function evi(a,b,c,d,e,f){a.fb=b;a.H=nu(Mui,{text:c,wmc:d,vmc:e});d&&!e&&(b=Tv(nw,"waffle-ritz-protection-acl-butter-action"),a.L=new pw(void 0,b,a.oa()),a.Ga(a.L),a.getHandler().listen(a.L,"action",f))}p.odc=function(a){"done"==a.key&&(this.nBa(),a.preventDefault())};function dvi(a,b){a.$a&&b.length&&a.$a(b,fvi,!0,"ritz-range")}function fvi(){};function gvi(a,b,c,d){a=new sxf(new exf([["AIzaSyBuUpn1wi2-0JpM3S-tq2csYx0z2_m_pqc","ANVavNLWozk6oXyP9qguyx4QAuef5j_qQw4Y3Rw",755,"MINIMAL_DOMAIN_GROUP","MISSED_LEGACY_INTEGRATION"],[]]));a.H=c||null;b&&uxf(a,b);L(a.D,5,d?4:1);return RAf(a)};function hvi(a){a=a||{};var b=a.displayName;a=a.Ghc;return R('<div class="'+S("goog-contacts-ui-autocomplete-name-nochat")+(a?" "+S("goog-contacts-ui-autocomplete-new-section"):"")+'">'+Q(b)+"</div>")};function A7(a,b,c,d,e,f,h,k,m,n){f=f||new ky(",;",'"');h=new wy(h||null,m||this,n);h.ea=!0;h.className=b;h.O=!0;hy.call(this,this,h,f);this.kU=this.O;this.kU.C=this;this.ma=a;this.Ia=c;this.xa=d||null;this.Nia=e||15;this.Aa=!!k}x(A7,hy);function ivi(a,b,c,d,e,f,h,k,m,n){b=new A7(null,b,void 0,f,c,d,e,void 0,void 0,h);dl(a);jvi.call(null,b,gvi(0,k,m,n));return b}function kvi(a,b,c,d,e,f,h){b=new A7(null,b,void 0,f,c,d,e,void 0,void 0,h);jvi(b,RAf(a));return b}
function jvi(a,b){b.qo(Xwf,oa);a.ma=b;a.Aa=!0;a.dma&&a.cma&&(a.C=a.ma.qo(a.dma,a.cma),a.dma=null,a.cma=null)}p=A7.prototype;p.Na=function(){this.kU.dispose();this.ma&&this.Aa&&Hf(this.ma);A7.bb.Na.call(this)};p.dma=null;p.cma=null;p.kU=null;p.JXa=!0;p.w7=function(a){return!!a.xa};
p.GJ=function(a,b,c){a={token:a,C:b,H:!0,D:this.JXa,R:1,Ca:Uwf,q2:this.Ia,filter:this.xa,J:!0,O:!!this.Ma,ma:!1};c=w(this.zBb,this,c);if(a.token&&""!=a.token)this.ma?(this.C&&(this.C.cancel(),this.C=null),this.C=this.ma.qo(a,c)):(this.dma=a,this.cma=c);else{b=new $wf;var d=[];this.xa&&(d=this.xa(d,a.token));b.D=Ca(c,d,b,null,a)}};p.zBb=function(a,b,c,d,e){a(e.token,b)};p.tx=function(a,b){A7.bb.tx.call(this,a,b)};p.vh=function(){A7.bb.vh.call(this)};
p.Dr=function(a,b,c){lu(c,hvi,{displayName:a.data.text,Ghc:!!(a.data.flags&1)})};p.mC=function(){var a=iy(this,this.J);return-1!=a&&(a=this.F[a],a.J)?(a.J(),!0):A7.bb.mC.call(this)};ma("createAutoComplete",function(a,b,c,d,e,f,h,k,m,n,q,t,v,z){d&&(b=b+d+"/");b=gvi(dl(b),t,v,z);f&&b.qo(Xwf,oa);c=new A7(b,c,void 0,m,e,k,n,!0);c.cga(ul(a));return c},void 0);function B7(){this.Oa=new Km(this);B7.prototype.addInput=B7.prototype.RIa;B7.prototype.removeInput=B7.prototype.Vnc;B7.prototype.setTarget=B7.prototype.Mu}B7.prototype.C=null;function lvi(a,b){var c=new B7;c.create(a,b);return c}ka._EmailAc_create=lvi;p=B7.prototype;
p.create=function(a,b){a=ul(a);this.C=b.contactStoreConfig?kvi(b.contactStoreConfig,b.acCssName||"ac-renderer",b.maxMatches||15,b.inputHandler,a.ownerDocument.body,b.filter,b.rightAlign):ivi(b.serverBase,b.acCssName||"ac-renderer",b.maxMatches||15,b.inputHandler,a.ownerDocument.body,b.filter,b.rightAlign,b.acd,b.onAuthError,b.tg);"groups"in b&&(this.C.JXa=b.groups);var c=b.onComplete;"function"===typeof c&&this.Oa.listen(this.C,"update",function(d){d.row&&c.call(ka,d.target.Np())});this.RIa(a)};
p.dispose=function(){If(this.C,this.Oa)};p.Mu=function(a){this.C.Mu(a)};p.RIa=function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this.C.kU.dga(a[b]);else this.C.kU.dga(a)};p.Vnc=function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this.C.kU.fwa(a[b]);else this.C.kU.fwa(a)};function C7(a,b,c,d,e,f,h){this.Aa="string"===typeof a?new Sk(a):a;this.Ia=!!c;this.R=d;this.ma=e;this.Ca=!!f;this.ea=h;this.J={};this.C={};this.O={};this.H={};this.D=null}function mvi(a,b){return new C7("/",a,void 0,void 0,void 0,void 0,b)}C7.prototype.xa=da("F");function nvi(a){this.params=a;this.q9=new Set;this.mH=null}nvi.prototype.Mu=function(a){this.mH&&this.mH.setTarget(a)};p=C7.prototype;
p.Bha=function(a){if(this.L)throw Error("Email autcomplete was already initialized. To attach it to an input field, please use attachAutocomplete()");this.L=!0;this.J=a||{};for(var b in this.C)ovi(this,this.C[b]);this.D&&(a=ya(this.D),(a=this.H[a])&&a.Mu(this.D));for(b in this.C){a=this.C[b];a=ha(a.q9.values()).concat();for(var c=1;c<a.length;c++)Hm(a[c],"focus",this.HCa,!1,this)}};
function ovi(a,b){var c=b.params;c.serverBase=a.Aa;c.onComplete=w(a.Iic,a);c.ua=a.Ia;c.acd=a.R;c.onAuthError=a.ma;c.tg=a.Ca;c.contactStoreConfig=a.ea;for(var d in a.J)c[d]=a.J[d];a=ha(b.q9.values()).concat();b.mH=lvi(a[0],c);for(c=1;c<a.length;c++)b.mH.addInput(a[c]);b.q9.clear()}
p.Rpa=function(a,b,c){a=ul(a);var d=b||{};b=ya(a);this.O[b]=c;c="";for(var e in d)c+=e+"="+d[e]+";";e=this.C[c];e||(e=new nvi(d),this.C[c]=e);d=e;c=a;d.mH?d.mH.addInput(c):d.q9.add(c);this.H[b]=e;e.mH||(this.L?ovi(this,e):Em(a,"focus",this.HCa,!1,this))};p.HCa=function(a){this.D=a.target;this.L||this.Bha()};p.Iic=function(a){var b=this.O[ya(a)];b&&b(a)};
p.ZLa=function(a){a=ul(a);Hm(a,"focus",this.HCa,!1,this);var b=ya(a);delete this.O[b];var c=this.H[b];c&&(c.mH?c.mH.removeInput(a):c.q9.delete(a),delete this.H[b])};p.Feb=function(a,b){this.Bha(b);this.Rpa(a,b)};ma("goog.NewContactTools",C7,void 0);ma("goog.NewContactTools.create",mvi,void 0);C7.prototype.setLocale=C7.prototype.xa;C7.prototype.attachAutocompleteTo=C7.prototype.Feb;C7.prototype.initAutocomplete=C7.prototype.Bha;C7.prototype.attachAutocomplete=C7.prototype.Rpa;
C7.prototype.detachAutocomplete=C7.prototype.ZLa;function pvi(a,b,c,d,e,f){P.call(this,f);this.L=a;this.J=new pw(void 0,y(A(),"docs-egms")?Ey.getInstance():yL.getInstance(),this.oa());this.Ga(this.J);this.C=new P(this.oa());this.Ga(this.C);this.D=new vx;this.Ga(this.D);this.ea=c||!1;this.ma=e||!1;this.F=-1;this.H=null;this.ue=b;this.R=d;this.O=new Cy(this.oa());this.qa(this.O)}u(pvi,P);p=pvi.prototype;p.Ba=function(){var a=nu(nui);this.qb(a)};
p.Ha=function(){P.prototype.Ha.call(this);this.C.Xa(this.Fa("waffle-flat-multi-range-holder"));this.J.Xa(this.Fa("waffle-flat-multi-range-add-another"));this.D.Xa(this.Fa("waffle-flat-multi-range-select-done"));this.getHandler().listen(this.J,"action",ke(this.B8)).listen(this.D,"action",this.uGb);this.D.setVisible(!1);this.B8(!0)};function qvi(a,b){for(var c=a.C.Dd(!0),d=0;d<c.length;d++)c[d].dispose();a.B8(!0);if(0<b.length)for(rvi(a,0).setValue(b[0]),c=1;c<b.length;c++)a.B8(!0).setValue(b[c])}
p.Od=function(){for(var a=[],b=0;b<D7(this);b++){var c=rvi(this,b).getValue();Gd(c)||a.push(c)}return a};p.setVisible=function(a){O(this.La(),a)};p.uGb=function(){svi(this,!1)};function svi(a,b){b?a.getHandler().listen(a.L,"selectionChange",a.$0a):(a.getHandler().Kc(a.L,"selectionChange",a.$0a),rvi(a,D7(a)-1).La().focus());Tu(a.La(),"waffle-flat-multi-range-select-listening",b);a.D.setVisible(b);a.ue(b)}
p.$0a=function(a){var b=a.lka;a=this.ma?a.Jm:null;if(1==b.length)this.F=-1,b=sK(b[0],a),this.H&&this.H.setValue(b);else{-1==this.F&&(this.F=D7(this)-1);for(var c=0;c<b.length;c++){var d=b[c],e=this.F+c;e=e>=D7(this)?this.B8():rvi(this,e);d=sK(d,a);e.setValue(d)}}};p.B8=function(a){var b=new tvi(this,this.ea,this.R,this.oa());this.C.Hf(b,D7(this),!0);uvi(this);a||vvi(b);return b};
p.iac=function(a){var b=this;this.C.removeChild(a,!0);a.dispose();uvi(this);Dy(this.O,"Range removed");Pm(function(){0<D7(b)&&vvi(rvi(b,D7(b)-1))},0,this)};function uvi(a){for(var b=D7(a),c=0;c<b;c++)rvi(a,c).D.setVisible(1!=b)}function D7(a){return a.C.zc()}function rvi(a,b){D7(a);return a.C.Ec(b)}function tvi(a,b,c,d){P.call(this,d);this.Dc=a;this.C=new BV(new Nm,w(this.S_b,this),b,c,!0,void 0,this.oa());this.Ga(this.C);this.D=new vx;this.Ga(this.D)}u(tvi,P);p=tvi.prototype;
p.Ba=function(){var a=nu(mui,{Fe:y(A(),"docs-egms")});this.qb(a)};p.Ha=function(){P.prototype.Ha.call(this);this.C.Xa(this.Fa("waffle-range-selection-holder"));this.D.Xa(this.Fa("waffle-flat-multi-range-remove"));Jw(this.D.La());this.getHandler().listen(this.D,"action",w(this.Dc.iac,this.Dc,this)).listen(this.C.Fd(),"focus",this.Z0a)};p.S_b=function(){vvi(this);svi(this.Dc,!0)};function vvi(a){gy(a.C.C);a.Z0a()}
p.Z0a=function(){Pu(this.C.La(),"waffle-flat-multi-range-active-editbox");var a=this.Dc;a.H=this;for(var b=0;b<D7(a);b++){var c=rvi(a,b);c!=this&&(Ru(c.C.La(),"waffle-flat-multi-range-active-editbox"),Ru(c.C.La(),"active"))}};p.getValue=function(){return this.C.getValue()};p.setValue=function(a){this.C.setValue(a)};function wvi(a,b,c,d,e){P.call(this,e);this.C=new BV(new Nm,w(this.mac,this),c,d,!0,void 0,this.oa());this.Ga(this.C);this.F=new vx("");this.Ga(this.F);this.D=null;this.H=a;this.ue=b}u(wvi,P);p=wvi.prototype;p.getValue=function(){return this.C.getValue()};p.setValue=function(a){this.C.setValue(a)};p.isEnabled=function(){return this.C.isEnabled()};p.Pa=function(a){this.C.Pa(a)};p.setVisible=function(a){O(this.La(),a)};p.isVisible=function(){return Nt(this.La())};p.Fd=function(){return this.C.Fd()};
p.Ba=function(){var a=nu(kui);this.qb(a)};p.Ha=function(){P.prototype.Ha.call(this);this.C.Xa(this.Fa("waffle-range-selection-holder"));var a=this.C.Fd();Pu(a,"waffle-flat-range-select");this.F.Xa(this.Fa("waffle-flat-range-select-done"));this.getHandler().listen(this.F,"action",this.jac);this.F.setVisible(!1)};p.mac=function(){xvi(this,!this.D)};
function xvi(a,b){b?a.D=Em(a.H,"selectionChange",a.nac,!1,a):(Im(a.D),a.D=null,a.La().focus());Tu(a.La(),"waffle-flat-range-select-listening",b);a.F.setVisible(b);a.ue(b)}p.nac=function(a){a=sK(a.rect,a.Jm);this.C.setValue(a)};p.jac=function(){xvi(this,!1)};p.Na=function(){P.prototype.Na.call(this);Im(this.D);this.D=null};function E7(a,b,c,d){P.call(this,d);this.F=a;this.O=b;this.Ia=c}u(E7,P);E7.prototype.Ha=function(){this.getHandler().listen(this.getElement(),"keydown",this.oBa).listen(this.getElement(),"keypress",this.oBa)};function yvi(a,b){return null!=b&&!b.jp()&&b.Af()&&e0e(a.O,gui(b))?f0e(a.O,gui(b)):"#REF"}E7.prototype.we=function(a){return null!=a&&a.Af()&&(a=SG(this.F,a.gb()),null!=a)?a.we():"#REF"};function zvi(a,b){zm.call(this,a,b)}u(zvi,zm);function Avi(a,b){this.Eb=a;this.C=b}Avi.prototype.getElement=g("Eb");Avi.prototype.getError=g("C");function F7(a,b,c,d,e){E7.call(this,a,b,c,e);var f=this;this.Qa=new vx("");this.qa(this.Qa);this.Ca=new vx("");this.qa(this.Ca);this.Aa=new vx("");this.qa(this.Aa);this.H=new dy;this.qa(this.H);this.Va=new By;this.qa(this.Va);this.Ya=this.Ma=this.Sa=null;this.D=new wvi(c,function(h){return f.Yga(h)},!1,"Select range",this.oa());this.Ga(this.D);this.L=new pvi(c,function(h){return f.Yga(h)},!1,"Select range",!1,this.oa());this.Ga(this.L);this.J=new hP(this.oa());this.Ra=!1}u(F7,E7);p=F7.prototype;
p.Ha=function(){E7.prototype.Ha.call(this);var a=this.oa();this.H.Xa(this.Fa("waffle-ritz-protection-add-description-input"));this.Va.Xa(this.H.La());this.L.Xa(this.Fa("waffle-flat-multi-range-select"));this.J.Xa(bm(a,"waffle-ritz-protection-holes-checkbox"));this.D.Xa(this.Fa("waffle-flat-range-select-holder"));this.Sa=bm(a,"waffle-ritz-protection-edit-sheet-select-holder");this.Ya=bm(a,"waffle-ritz-protection-edit-permissions");this.Ma=bm(a,"waffle-ritz-protection-edit-permissions-description");
this.Qa.Xa(bm(a,"waffle-ritz-protection-edit-permissions-button"));this.Ca.Xa(bm(a,"waffle-ritz-protection-edit-done"));this.Aa.Xa(bm(a,"waffle-ritz-protection-edit-cancel"));Jw(bm(a,"waffle-ritz-protection-edit-validation-error-icon"));KR(this.H,"Enter a description");this.k7()&&O(this.Ya,!1);this.D.setValue(this.vQa());a=bm(a,"waffle-ritz-protection-holes-checkbox-label");qx(this.J,a);a=this.tQa();qvi(this.L,a);this.J.Lb(!!a.length);this.L.setVisible(!!a.length);this.getHandler().listen(this.Qa,
"action",this.iTb).listen(this.Ca,"action",this.sdc).listen(this.Aa,"action",this.rdc).listen(this.J,"change",this.dKb);this.fN()&&(this.H.Pa(!1),this.D.Pa(!1),this.J.Pa(!1))};p.oBa=function(a){a.stopPropagation();"keydown"==a.type&&27==a.keyCode?Bvi(this):"keypress"==a.type&&13==a.keyCode&&Cvi(this)};p.focus=function(){gy(this.H)};function Dvi(a,b){Gd(b)?O(a.Ma,!1):(O(a.Ma,!0),a.oa().Ke(a.Ma,b))}p.Vd=function(){return this.H.getValue()};p.getRange=function(){return this.D.getValue()};
p.Mw=function(){return this.J.isChecked()?this.L.Od():[]};p.Yga=function(a){var b=this.H;b&&b.Pa(!a);(b=this.Ca)&&b.Pa(!a);(b=this.Aa)&&b.Pa(!a)};p.rdc=function(){Bvi(this)};function Bvi(a){a.dispatchEvent(new zvi("ritz-protection-pill-edit-cancel",a))}p.qP=function(){this.D.setVisible(!0);O(this.Sa,!1);Evi(this)};p.V0=function(){this.D.setVisible(!1);xvi(this.D,!1);O(this.Sa,!0);Evi(this)};
p.iTb=function(){this.Ra=!0;var a=this.getError();Fvi(this,a);a||this.dispatchEvent(new zvi("ritz-protection-set-permissions",this))};p.sdc=function(){Cvi(this)};p.dKb=function(){if(0==this.L.Od().length&&this.J.isChecked()){var a=this.Ia.C();a instanceof LN&&(a=FNc(a),qvi(this.L,[sK(a.rect)]))}this.L.setVisible(this.J.isChecked())};function Cvi(a){var b=a.getError();Fvi(a,b);b||a.dispatchEvent(new zvi("ritz-protection-pill-submit",a))}
p.getError=function(){var a=this.D.Fd();var b=Gvi(this);null!==b&&e0e(this.O,b)?b.C?b=b.C:(b=f0e(this.O,b),b=null===b?null:g0e(this.O,b)):b=null;var c=b;if(null===c)return new Avi(a,"Invalid range");b=this.F.F[c.C];c=0==b.getSheetType()&&HH(b.Jc(),c.rect);return this.fN()||!b.D&&!c?null:new Avi(a,"You are trying to edit a protected cell or object. Please contact the spreadsheet owner to remove protection if you need to edit.")};
function Gvi(a){if(a.jp()){var b=a.gb();return new dU(new PE(a.F.F[b].gb(),ene()),null)}return d0e(a.O,a.getRange())?i0e(a.O,a.getRange()):null}function Hvi(a){if(!a.jp())return[];for(var b=a.Mw(),c=[],d=0;d<b.length;d++){var e=g0e(a.O,b[d]);e&&e.C==a.gb()&&c.push(new dU(e,null))}return c}
function Evi(a){var b=a.oa();a=b.qf("waffle-ritz-protection-select-error",a.La());Tc(a,function(c){Ru(c,"waffle-ritz-protection-select-error")});b=b.getElement("waffle-ritz-protection-edit-validation-error");O(b,!1)}function Fvi(a,b){Evi(a);if(b){a=a.oa();var c=a.getElement("waffle-ritz-protection-edit-validation-error"),d=a.getElement("waffle-ritz-protection-edit-validation-error-text");a.Ke(d,b.getError());O(c,!0);Pu(b.getElement(),"waffle-ritz-protection-select-error")}};function Ivi(a,b){var c="";a.Fe?(c+='<div class="waffle-ritz-protection-pill waffle-ritz-protection-edit-pill"><div class="waffle-ritz-protection-pill-contents"><div><input value="" class="waffle-ritz-protection-add-description-input jfk-textinput"></div><div class="waffle-ritz-protection-toggle-tabs"></div><div class="waffle-ritz-protection-tab-separator"></div><div class="waffle-ritz-protection-range-tab">'+Q(kui(null,b))+'</div><div id="waffle-ritz-protection-edit-sheet-select-holder" class="waffle-ritz-protection-sheet-tab"><div id="waffle-ritz-protection-edit-sheet-select" aria-label="',
c+=vu("Sheet list"),c+='"></div>'+Jvi(b)+'</div><div id="waffle-ritz-protection-edit-validation-error" style="display: none" aria-live="polite"><span id="waffle-ritz-protection-edit-validation-error-text"></span><a href="//support.google.com/docs/bin/answer.py?answer=63175" id="waffle-ritz-protection-edit-validation-error-icon" target="_blank" title="',c+=vu("Learn more"),c+='">?</a></div></div><div id="waffle-ritz-protection-edit-permissions" class="waffle-ritz-protection-edit-permissions waffle-ritz-protection-pill-contents"><div class="waffle-ritz-protection-edit-permissions-title">'+
Q(Fy({Qn:"waffle-ritz-protection-edit-permissions-lock",icon:"docs-icon-img docs-icon-locked"},b)),c=c+'Permissions</div><div id="waffle-ritz-protection-edit-permissions-description" class="waffle-ritz-protection-edit-permissions-description"></div>'+Q(ux({od:"waffle-ritz-protection-edit-permissions-button",content:tu("Change permissions"),id:"waffle-ritz-protection-edit-permissions-button",style:0},b)),c=c+'</div><div class="waffle-ritz-protection-pill-contents waffle-ritz-protection-edit-buttons">'+
Q(ux({od:"waffle-ritz-protection-edit-cancel",content:tu("Cancel"),id:"waffle-ritz-protection-edit-cancel",style:0},b)),c+=Q(ux({od:"waffle-ritz-protection-edit-done",content:tu("Set permissions"),id:"waffle-ritz-protection-edit-done",style:2},b)),c+="</div></div>"):(a='<div id="waffle-ritz-protection-edit-sheet-select" aria-label="'+vu("Sheet list"),a+='"></div>'+Jvi(b),c+=Kvi({xya:!0,description:"",nZ:!1,kya:!0,Fe:!1,eFa:tu(a)},b));return R(c)}
function Lvi(a,b){return R(Kvi({xya:!1,description:a.description,nZ:!0,kya:!1,Fe:a.Fe,eFa:tu('<div id="waffle-ritz-protection-edit-sheet-label">'+Q(a.Jm)+"</div>"+Jvi(b))},b))}function Mvi(a,b){return R(Kvi({xya:!1,description:a.description,nZ:!1,kya:!1,Fe:a.Fe,eFa:tu('<div id="waffle-ritz-protection-edit-sheet-label">'+Q(a.Jm)+"</div>"+Jvi(b))},b))}
function Kvi(a,b){var c=a.xya,d=a.nZ,e=a.kya,f=a.Fe,h=a.eFa,k='<div class="waffle-ritz-protection-pill waffle-ritz-protection-edit-pill"><div class="waffle-ritz-protection-pill-contents"><div><input value="'+S(a.description)+'" class="waffle-ritz-protection-add-description-input waffle-ritz-protection-edit-description-input jfk-textinput">';d?(a=""+Q(ux({content:tu(""+Q(Fy({icon:"docs-icon-img "+(a.Fe?"docs-icon-delete-grey600-24":"docs-icon-trash")},b))),id:"waffle-ritz-protection-edit-delete",style:4,
title:"Delete range or sheet protection"},b)),a=R(a)):a="";k=k+a+"</div>";e?(e="<div>"+Q(ux({od:"waffle-ritz-protection-edit-toggle-range",content:tu("Range"),id:"waffle-ritz-protection-edit-toggle-range",style:0},b)),e+=Q(ux({od:"waffle-ritz-protection-edit-toggle-sheet",content:tu("Sheet"),id:"waffle-ritz-protection-edit-toggle-sheet",style:0},b)),e=R(e+"</div>")):e="";h=k+e+Q(kui(null,b))+'<div id="waffle-ritz-protection-edit-sheet-select-holder">'+Q(h)+'</div><div id="waffle-ritz-protection-edit-validation-error" style="display: none" aria-live="polite"><span id="waffle-ritz-protection-edit-validation-error-text"></span><a href="//support.google.com/docs/bin/answer.py?answer=63175" id="waffle-ritz-protection-edit-validation-error-icon" target="_blank" title="';
h+=vu("Learn more");h+='">?</a></div></div><div id="waffle-ritz-protection-edit-permissions" class="waffle-ritz-protection-edit-permissions waffle-ritz-protection-pill-contents"><div class="waffle-ritz-protection-edit-permissions-title">'+Q(Fy({Qn:"waffle-ritz-protection-edit-permissions-lock",icon:"docs-icon-img docs-icon-locked"},b));h=h+'Permissions</div><div id="waffle-ritz-protection-edit-permissions-description" class="waffle-ritz-protection-edit-permissions-description"></div>'+Q(ux({od:"waffle-ritz-protection-edit-permissions-button",
content:tu("Change permissions"),id:"waffle-ritz-protection-edit-permissions-button",style:0},b));h+='</div><div class="waffle-ritz-protection-pill-contents waffle-ritz-protection-edit-buttons">';f&&(h+=Q(ux({od:"waffle-ritz-protection-edit-cancel",content:tu("Cancel"),id:"waffle-ritz-protection-edit-cancel",style:0},b)));h+=Q(ux({od:"waffle-ritz-protection-edit-done",content:tu(c?"Set permissions":"Done"),id:"waffle-ritz-protection-edit-done",style:2},b));f||(h+=Q(ux({od:"waffle-ritz-protection-edit-cancel",
content:tu("Cancel"),id:"waffle-ritz-protection-edit-cancel",style:0},b)));return R(h+"</div></div>")}function Jvi(a){a='<div><div class="waffle-ritz-protection-holes-checkbox-container"><div id="waffle-ritz-protection-holes-checkbox" role="checkbox"></div><span id="waffle-ritz-protection-holes-checkbox-label">Except certain cells</span></div>'+(Q(nui(null,a))+"</div>");return R(a)};function Nvi(a,b,c,d,e){F7.call(this,a,b,c,d,e);this.R=y(A(),"docs-egms");this.$a=en().Zea()();this.R?(this.C=new AX("Range","Sheet",!0,e),this.Ga(this.C)):(this.xa=hS(""),this.qa(this.xa),this.ma=hS(""),this.qa(this.ma));this.ea=new JE("");this.qa(this.ea)}u(Nvi,F7);p=Nvi.prototype;p.Ba=function(){var a=nu(Ivi,{Fe:this.R});this.qb(a)};
p.Ha=function(){F7.prototype.Ha.call(this);var a=this.oa();if(this.R){var b=this.Fa("waffle-ritz-protection-range-tab");this.C.D=b;b=this.Fa("waffle-ritz-protection-sheet-tab");this.C.F=b;this.C.render(this.Fa("waffle-ritz-protection-toggle-tabs"));this.C.Ha()}else this.xa.Xa(a.getElement("waffle-ritz-protection-edit-toggle-range")),this.xa.Er(2),this.ma.Xa(a.getElement("waffle-ritz-protection-edit-toggle-sheet")),this.ma.Er(1),this.qP();a=a.getElement("waffle-ritz-protection-edit-sheet-select");
this.ea.Xa(a);this.ea.ji(!0);Ovi(this);this.getHandler().listen(this.F,"ya",this.qdc);this.R?this.getHandler().listen(this.C,"docs-sidebar-toggle-tab-left-activate",this.PVa).listen(this.C,"docs-sidebar-toggle-tab-right-activate",this.CWa):this.getHandler().listen(this.xa,"action",this.PVa).listen(this.ma,"action",this.CWa)};p.qdc=function(){Ovi(this,this.gb())};
function Ovi(a,b){a.ea.Ne(null);var c;b&&SG(a.F,b)?c=b:a.F.C&&(c=a.F.C.gb());Tc(a.F.D,function(d){var e=new tw(d.we(),d);a.ea.Wc(e);null!=c&&d.gb()==c&&Qw(a.ea,e)})}p.PVa=function(){this.qP()};p.CWa=function(){this.V0()};p.qP=function(){F7.prototype.qP.call(this);this.R?this.C.C||BX(this.C,!0):(this.xa.Lb(!0),this.ma.Lb(!1))};p.V0=function(){F7.prototype.V0.call(this);this.R?this.C.C&&BX(this.C,!1):(this.ma.Lb(!0),this.xa.Lb(!1))};p.jp=function(){return this.R?!this.C.C:this.ma.isChecked()};
p.k7=l(!0);p.xC=l(!1);p.fN=l(!1);p.yGa=ca();p.Ok=g("$a");p.gb=function(){return this.ea.tf().Ua().gb()};p.vQa=function(){var a=this.Ia.C();if(a instanceof LN){a=FNc(a);var b=SG(this.F,a.C).we();return sK(a.rect,b)}return""};p.tQa=function(){return[]};function Pvi(a,b,c,d,e,f,h){F7.call(this,b,c,d,f,h);this.ea=y(A(),"docs-egms");this.Gb(a);this.R=e;this.C=new vx("");this.qa(this.C)}u(Pvi,F7);p=Pvi.prototype;p.Ba=function(){var a=this.Ua(),b=this.fN()?Mvi:Lvi;a=nu(b,{description:a.Vd(),jp:this.jp(),Jm:this.we(a),Fe:this.ea});this.qb(a)};
p.Ha=function(){F7.prototype.Ha.call(this);var a=this.oa();this.jp()?this.V0():this.qP();this.fN()||(this.C.Xa(a.getElement("waffle-ritz-protection-edit-delete")),this.getHandler().listen(this.C,"action",this.tdc),Jw(this.C.getElement()));a=this.Ua();this.yGa(a.R,a.O,a.xC())};
p.tdc=function(){var a=this,b=w(this.dispatchEvent,this,new zvi("ritz-protection-range-delete",this));bOc(this.R,"Anyone who has edit access to the spreadsheet will be able to edit content in the range.",b,{ok:"Remove",cancel:"Cancel"},"Are you sure that you want to remove this protected range?",function(){a.C.getElement().focus()},void 0,!0)};p.Yga=function(a){this.C.Pa(!a);F7.prototype.Yga.call(this,a)};p.jp=function(){return this.Ua().jp()};p.k7=l(!1);p.xC=function(){return this.Ua().xC()};
p.fN=function(){return!this.Ua().um()&&dui()};
p.yGa=function(a,b,c){c?Dvi(this,"Editable by everyone (warn before editing)"):this.fN()?Dvi(this,"You can't edit this range, but you can change who can edit it."):(a=0==a&&0==b?"Only you can edit this range.":(new Xx(0==b?"{NUM_USERS,plural, =0{unused plural form}=1{You and one other user can edit this range.}other{You and # other users can edit this range.}}":0==a?"{NUM_GROUPS,plural, =0{unused plural form}=1{You and one group can edit this range.}other{You and # groups can edit this range.}}":1==
b?"{NUM_USERS,plural, =0{unused plural form}=1{You, one other user and one group can edit this range.}other{You, # other users and 1 group can edit this range.}}":"{NUM_USERS,plural, =0{unused plural form}=1{You, 1 other user and {NUM_GROUPS} groups can edit this range.}other{You, # other users and {NUM_GROUPS} groups can edit this range.}}")).format({NUM_USERS:a,NUM_GROUPS:b}),Dvi(this,a))};p.vQa=function(){return yvi(this,this.Ua())};
p.tQa=function(){for(var a=[],b=this.Ua().Mw(),c=0;c<b.length;c++)a.push(sK(b[c]));return a};p.Ok=function(){return this.Ua().getId()};p.gb=function(){return this.Ua().gb()};function Qvi(a,b){var c='<div id="waffle-ritz-protection-container"><div id="waffle-ritz-protection-active-pill-container"></div><div id="waffle-ritz-protection-view-pills-container"><div id="waffle-ritz-protection-add-range" class="waffle-ritz-protection-link-button waffle-ritz-protection-add-range-inactive" tabindex=0>'+(a.Fe?Q(Fy({Qn:"waffle-ritz-protection-add-range-icon",icon:"docs-icon-img docs-icon-plus"},b))+"<span>"+R("Add a sheet or range")+"</span>":"<strong>+ "+R("Add a sheet or range")+
"</strong>")+"</div>";var d=R('<div id="waffle-ritz-protection-promo"><div class="waffle-ritz-protection-promo-content"><table><tr><td><div class="waffle-ritz-protection-promo-lock-container"><div class="waffle-ritz-protection-promo-lock"></div></div></td><td>Protect ranges to control who can edit specific data on the sheet.</td></tr></table></div><hr class="waffle-ritz-protection-promo-separator"/><div><a href="http://support.google.com/docs/bin/answer.py?answer=144687" target="_blank">Learn more about protected sheets and ranges.</a></div></div>');
c=c+Q(d)+'<div id="waffle-ritz-protection-pills-container"></div><div class="waffle-ritz-protection-range-links"><div id="waffle-ritz-protection-show-all" class="waffle-ritz-protection-link-button waffle-ritz-protection-show-all" tabindex=0>';c+='Show all protected ranges</div><div id="waffle-ritz-protection-show-fewer" class="waffle-ritz-protection-link-button waffle-ritz-protection-show-fewer" tabindex=0>Show only this sheet\'s protected ranges</div></div></div></div>';a=""+Q(NV(qu({title:"Protected sheets and ranges",
jG:tu(""+Q(Fy({Qn:"docs-gm-sidebar-icon-24",icon:"docs-icon-img docs-icon-sheets-table-24"},b))),Lk:tu(c)},a),b));return R(a)};function Rvi(a,b){var c=a.Itc,d=a.yDa,e=a.um,f=a.Xfb;a='<div class="waffle-ritz-protection-pill waffle-ritz-protection-pill-contents waffle-ritz-protection-view-pill" tabindex=0><div class="waffle-ritz-protection-range-name"><span aria-label="" class="waffle-ritz-protection-range-name-holder" title='+LU(a.$gb)+">"+Q(c)+'</span></div><div class="waffle-ritz-protection-range-rect"><span aria-label="" class="waffle-ritz-protection-range-rect-holder" title="'+S(d)+'">'+Q(d)+"</span></div><div><table><tr><td>"+
Q(Fy({icon:"docs-icon-img docs-icon-locked"},b))+"</td>";return R((f?a+"<td>Can edit (with warnings)":e?a+"<td>Can edit":a+"<td>View only")+"</td></tr></table></div></div>")};function Svi(a,b,c,d,e,f){E7.call(this,b,c,d,f);this.Gb(a);this.C=null}u(Svi,E7);p=Svi.prototype;p.Vd=function(){return this.Ua().Vd()};p.Ok=function(){return this.Ua().getId()};
p.Ba=function(){var a=this.Ua(),b=this.jp()?Tvi(this,a):yvi(this,a),c=this.Vd(),d=cf(c,80);a=this.Ua().um();var e=this.Ua().xC();b=nu(Rvi,{$gb:c,Itc:d,yDa:b,um:a,Xfb:e});Gu(b,"button");Iu(b,"disabled",!a);a=this.Ua();a=this.Ua().um()?this.Ua().xC()?this.jp()?"Edit protected sheet "+(this.Vd()+(" "+(Tvi(this,a)+" with warnings"))):"Edit protected range "+(this.Vd()+(" "+(yvi(this,a)+" with warnings"))):this.jp()?"Edit protected sheet "+(this.Vd()+(" "+Tvi(this,a))):"Edit protected range "+(this.Vd()+
(" "+yvi(this,a))):this.jp()?"View-only protected sheet "+(this.Vd()+(" "+Tvi(this,a))):"View-only protected range "+(this.Vd()+(" "+yvi(this,a)));Lu(b,a);this.qb(b)};
p.Ha=function(){E7.prototype.Ha.call(this);var a=this.La();this.getHandler().listen(a,"mouseover",this.Kdc).listen(a,"mouseout",this.Jdc).listen(a,"focus",this.Idc).listen(a,"blur",this.Gdc).listen(a,"click",this.Hdc);a=this.Fa("waffle-ritz-protection-range-name-holder");var b=this.Fa("waffle-ritz-protection-range-rect-holder");Jw(a);Jw(b)};p.jp=function(){return this.Ua().jp()};
function Tvi(a,b){a=a.we(b);b=b.Mw();var c=1==b.length?sK(b[0]):"";return(new Xx("{NUM_HOLES,plural, =0{{SHEET_NAME}}=1{{SHEET_NAME} except {ONE_HOLE_RANGE}}other{{SHEET_NAME} except # ranges}}")).format({NUM_HOLES:b.length,SHEET_NAME:a,ONE_HOLE_RANGE:c})}p.Kdc=function(){Uvi(this)};p.Idc=function(){Uvi(this)};p.Jdc=function(){Hf(this.C);this.C=null};p.Hdc=function(){Vvi(this)};p.Gdc=function(){Hf(this.C);this.C=null};
function Uvi(a){var b=a.Ua();a.jp()||a.C||!b.Af()||hU(a.Ia)!=b.gb()||(a.C=eN(iI(a.Ia),b.getRect(),"waffle-ritz-protection-border",2,1),a.C.setVisible(!0))}p.oBa=function(a){"keypress"==a.type&&13==a.keyCode&&(a.preventDefault(),Vvi(this))};function Vvi(a){a.dispatchEvent(new zvi("ritz-protection-edit-pill",a))}p.focus=function(){this.getElement().focus()};p.Na=function(){E7.prototype.Na.call(this);Hf(this.C);this.C=null};function Wvi(a,b,c,d){oV.call(this,d);this.H=a;this.R=b;this.F=c;this.J=c.$a;this.D=[];a=Tv(nw,"waffle-ritz-protection-link-button");this.L=new pw(void 0,a,this.oa());this.Ga(this.L);this.ea=new pw(void 0,a,this.oa());this.Ga(this.ea);this.ma=new pw(void 0,a,this.oa());this.Ga(this.ma);this.C=null;this.O=!1}u(Wvi,oV);p=Wvi.prototype;p.Ba=function(){var a=nu(Qvi,{IXa:!this.F.Ud(),id:this.getId(),Fe:y(A(),"docs-egms")});this.qb(a)};
p.Ha=function(){oV.prototype.Ha.call(this);var a=this.oa();this.xa=bm(a,"waffle-ritz-protection-active-pill-container");this.Aa=bm(a,"waffle-ritz-protection-view-pills-container");this.Ca=bm(a,"waffle-ritz-protection-pills-container");this.Ia=this.Fa("waffle-sidebar-content");this.L.Xa(bm(a,"waffle-ritz-protection-add-range"));this.getHandler().listen(this.L,"action",this.Ddc);this.ea.Xa(bm(a,"waffle-ritz-protection-show-all"));this.ma.Xa(bm(a,"waffle-ritz-protection-show-fewer"));this.getHandler().listen(this.ea,
"action",this.gUb).listen(this.ma,"action",this.qUb)};p.Sc=function(a){var b=Kmc(this.J);this.reset();if(b.length){Xvi(this);for(var c=hU(this.H),d=0;d<b.length;d++){var e=b[d],f=e.gb()==c;if(this.O||f)e=Yvi(this,e),this.Ca.appendChild(e.getElement()),this.D.push(e)}}Zvi(this);this.L.setVisible(!this.F.Ud());a&&$vi(this,a)||!this.L.isVisible()||this.L.getElement().focus()};function $vi(a,b){if(b=awi(a,b))Et(b.getElement(),a.Ia,!0),b.focus();return!!b}
function Zvi(a,b){var c=!1,d=!1;if(!b){b=!1;c=hU(a.H);d=Kmc(a.J);for(var e=0;e<d.length;e++)if(d[e].gb()!=c){b=!0;break}a.O?(c=b,d=!1):(c=!1,d=b)}a.ea.setVisible(d);a.ma.setVisible(c)}function awi(a,b){return null!=a.C?a.C.Ok()==b?a.C:null:ad(a.D,function(c){return c.Ok()==b})}function bwi(a,b){var c=ad(a.D,function(d){return d.Ok()==b});c&&(kd(a.D,c),Hf(c));null!=a.C&&a.C.Ok()==b&&(XN(a.R,"","Sorry, this protected sheet or range was deleted."),cwi(a))}
function dwi(a){var b=new Nvi(a.F.C,a.F.Ya,a.H,a.J);ewi(a,b);return b}function ewi(a,b){cwi(a);b.le(a);b.render(a.xa);a.C=b;O(a.xa,!0);O(a.Aa,!1);Zvi(a,!0);b.focus()}function cwi(a){if(a.C){var b=a.C.Ok();Hf(a.C);a.C=null;a.Sc(b)}}function Yvi(a,b){b=new Svi(b,a.F.C,a.F.Ya,a.H,a.F.H);b.le(a);b.render();return b}
function fwi(a,b){var c=cd(a.D,function(d){return 0<Ed(d.Ua().Vd(),b.Ua().Vd())});-1==c?(a.Ca.appendChild(b.getElement()),a.D.push(b)):(a.oa().pr(b.getElement(),a.D[c].getElement()),jd(a.D,c,0,b))}p.reset=function(){Hf(this.C);this.C=null;If(this.D);this.D=[];O(this.xa,!1);O(this.Aa,!0)};p.Ddc=function(){jI(this.H)?dwi(this).qP():dwi(this).V0()};p.gUb=function(){this.O=!0;this.Sc()};p.qUb=function(){this.O=!1;this.Sc()};
function Xvi(a){a=a.oa();var b=a.getElement("waffle-ritz-protection-promo");b&&a.removeNode(b)}p.Na=function(){oV.prototype.Na.call(this);If(this.D);this.D=[]};function gwi(a){this.rb=hn(a,-1,0)}u(gwi,mn);gwi.prototype.kb=function(){return new hwi(this)};gwi.prototype.Kl=function(){return qn(this,2)};gwi.prototype.getData=function(){return this.Mb(2,Dui)};function hwi(a){Cn.call(this,a)}u(hwi,Cn);hwi.prototype.Kl=function(){return this.message.Kl()};hwi.prototype.getData=function(){return this.message.getData()};function iwi(a,b,c,d){cI.call(this,65);this.ld=a;this.Wj=Hd(b);this.F=c;this.C=d}u(iwi,cI);iwi.prototype.Kk=function(){return"Added protected range "+(this.Wj+".")};iwi.prototype.Pd=function(){var a=Eui().Di(this.Wj);var b=r5e(this.F);a=Kn(a,5,b);for(b=0;b<this.C.length;b++){var c=r5e(this.C[b]);In(a,6,c)}var d=void 0===d?on(gwi):d;d=new hwi(d);a=Dn(a);d=Kn(d,2,a);d=Mn(d,3,this.ld);return Dn(d)};iwi.prototype.wg=l(!1);function jwi(a){this.rb=hn(a,-1,0)}u(jwi,mn);jwi.prototype.kb=function(){return new kwi(this)};function kwi(a){Cn.call(this,a)}u(kwi,Cn);function lwi(a,b){cI.call(this,67);this.ld=a;this.Wj=Hd(b)}u(lwi,cI);lwi.prototype.Kk=function(){return"Deleted protected range "+(this.Wj+".")};lwi.prototype.Pd=function(){var a=void 0===a?on(jwi):a;a=new kwi(a);a=Mn(a,1,this.ld);return Dn(a)};lwi.prototype.wg=l(!1);function mwi(a,b,c,d,e,f,h,k){wU.call(this,a,f);this.C=a;this.D=b;this.H=b.C;this.F=d;this.J=e;this.ma=h;this.ea=k;this.L=new Km(this);this.qa(this.L);this.L.listen($H,"show-ritz-protection",this.Adc).listen($H,"show-ritz-protection-with-range",this.xUb).listen($H,"show-ritz-protection-with-sheet",this.yUb).listen(this.H,"oa",this.ydc).listen(this.H,"va",this.zdc).listen(this.D.H,["acl_change","commenter_status","readonly_status"],this.Cdc).listen(this.C,"ritz-protection-edit-pill",this.dHb).listen(this.C,
"ritz-protection-range-delete",this.Bdc).listen(this.C,"ritz-protection-pill-submit",this.vdc).listen(this.C,"ritz-protection-set-permissions",this.jTb).listen(this.C,"ritz-protection-pill-edit-cancel",this.udc).listen(this.D,"add_ritz_protection",this.wdc).listen(this.D,"delete_ritz_protection",this.xdc)}u(mwi,wU);p=mwi.prototype;
p.wdc=function(a){var b=this.C;a=a.F.getId();var c=b.J.C[a];if(null!=c)if(a=awi(b,a),null!=b.C)a==b.C&&(a=b.C.Ua(),b.C.fN()&&c.um()?(Hf(b.C),b.C=null,a=new Pvi(c,b.F.C,b.F.Ya,b.H,b.R,b.J),ewi(b,a)):a.equals(c)?b.C.Gb(c):(XN(b.R,"","Sorry, another user just changed this protected range."),cwi(b)));else{var d=c.gb(),e=hU(b.H);if(b.O||d==e)c=Yvi(b,c),a?(d=gm(b.oa())==a.getElement(),b.oa().RA(c.getElement(),a.getElement()),e=Sc(b.D,a),jd(b.D,e,1,c),Hf(a),c.le(b),d&&c.focus()):(Xvi(b),fwi(b,c));Zvi(b)}};
p.xdc=function(a){bwi(this.C,a.F.getId())};p.zdc=function(){this.C.Sc()};p.ydc=function(){this.C.C||this.C.Sc()};p.Adc=function(){var a=this.Vf().isVisible();xU(this);this.C.Sc();a&&!this.D.Ud()&&dwi(this.C).qP()};p.xUb=function(){xU(this);this.C.Sc();this.D.Ud()||dwi(this.C).qP()};p.yUb=function(){xU(this);this.C.Sc();this.D.Ud()||dwi(this.C).V0()};
p.dHb=function(a){var b=a.target;a=b.Ua();if(null!=a){if(!this.D.Ud()&&(a.um()||dui())){var c=this.C;b=eui(c.J,b.Ok());b=new Pvi(b,c.F.C,c.F.Ya,c.H,c.R,c.J);ewi(c,b)}c=a.gb();a.Af()&&null!=c&&(b=a.getId(),a=a.getRect()||new bE(0,0,1,1),WG(this.H,new PE(c,a),w(this.hob,this,b)))}};p.udc=function(){cwi(this.C)};
p.vdc=function(a){var b=this,c=a.target;a=c.Vd();var d=Gvi(c),e=Hvi(c),f=c.Ok(),h=c.k7(),k=c.xC();if(c.fN())this.C.Sc(f);else{if(h){var m=new iwi(f,a,d,e);c.Ra||dI(m,function(q){q&&nwi(b,f)})}else{h=a!=c.Ua().Vd();c=c.Ua().Mw();var n=new Ak;Bk(n,c.map(function(q){return fOb(q)}));c=e.length!=c.length||!e.every(function(q){return n.contains(fOb(q.C.rect))});m=new Iui(f,h?a:void 0,d,c?e:void 0,k)}this.C.Sc(f);d.C&&hE(d.C.rect)?this.ma.D.Kt(function(){b.F.C(m)}):this.F.C(m)}};
p.jTb=function(a){a=a.target.Ok();nwi(this,a)};function nwi(a,b){bJ(a.D.H)?XN(a.J,"","You cannot set permissions while offline. Please try again when you come back online."):fui(a.J,b,a.ea,w(a.OPb,a,b))}p.OPb=function(a,b,c){var d=awi(this.C,a);d?d instanceof F7?(b&&(c?d.yGa(vn(c,1),vn(c,2),tn(c,3)):Dvi(d,"")),d.Ra?d.Qa.focus():d.focus()):$vi(this.C,a):this.C.focus();this.R.Hb(2)};p.hob=function(a){this.isDisposed()||((a=a?awi(this.C,a):this.C.C)?a.focus():this.C.focus(),this.R.Hb(2))};
p.Bdc=function(a){var b=a.target;a=b.Vd();b=b.Ok();a=new lwi(b,a);this.C.Sc();this.F.C(a)};p.Cdc=function(){this.C.Sc()};p.Vf=function(){return DAb};p.$o=function(){return EAb};function owi(){Vm.apply(this,arguments)}u(owi,Vm);owi.prototype.F=function(){return mwi};owi.prototype.H=function(){return Wvi};owi.prototype.C=function(){var a=4;switch(Oc(A(),"jobset")){case "scary":a=3;break;case "canary":a=2;break;case "prod":a=1}var b=new sxf(new exf([["AIzaSyBuUpn1wi2-0JpM3S-tq2csYx0z2_m_pqc","ANVavNLWozk6oXyP9qguyx4QAuef5j_qQw4Y3Rw",742,"MINIMAL_DOMAIN_GROUP","TRIX_WAFFLE"],[]]));L(b.D,5,a);return mvi("ritz_range",b)};
owi.prototype.D=function(a,b,c,d,e,f,h,k,m){return new avi(a,b,c,d,e,new Jui(f,h,b),k,m)};cn("ritzprotectionpane",owi);
